kind: pipeline
type: docker
name: build

steps:
- name: build-angular
  image: circleci/node:14.18.2-buster
  user: root
  commands:
    - cd angular-app/
    - npm install
    - npm run build --configuration=production

- name: build-golang
  image: circleci/golang:1.17-buster-browsers-legacy
  user: root
  commands:
    - apt-get update
    - apt-get install libfftw3-dev
    - apt-get install libsndfile1-dev
    - go test ./...
    - go build -o bin/templater
